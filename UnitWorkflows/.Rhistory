d <- read.csv(file="scalesia1.csv", sep = ";" )
d
d <- read.csv(file="scalesia1.csv", sep = "\" )
nam <- list.files(path = "C:\\Users\\a665q360\\Documents\\Gbif data",
d <- read.csv(file="scalesia1.csv", sep = "\t" )
d
# # Creating a list whit the paths for reading and writing each .csv
# Sawfly
D <- read.csv(path = "scalesia1.csv",  header = FALSE, sep = ";")
# # Creating a list whit the paths for reading and writing each .csv
# Sawfly
D <- read.csv(path = "scalesia1.csv",  header = TRUE, sep = ";")
# install.packages("remotes")
remotes::install_github("rstudio/tensorflow")
library(tensorflow)
install_tensorflow(envname = "r-tensorflow")
reticulate::install_python(version = '<version>')
#Setting my working directory:
setwd("C:/Users/asque/Documents/ML/QuezadaMLbiol/UnitCARET")
data <- read.csv("AirQualityUCI1.csv")
#Libraries
library(caret)
library(RANN)
library(dplyr)
library(ggplot2)
#Data preparation
head(data)
dim(data)
data <- data[, 3:15]
is.na(data)
#To obtain the pollution column base on maximum level of concentration.
umbral_Nox.GT <- 53
umbral_C6H6 <- 5
umbral_CO <- 6
data$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
hist(data$contaminacion)
hist(data)
#To omit NAs
data_clean <- na.omit(data)
hist(data_clean)
hist(data$CO.GT.)
par(mfrow = c(1, 3))
hist(data$CO.GT.)
hist(data$C6H6.GT.)
hist(data$NOx.GT.)
source(file = "colores.R")
source(file = "colores.R")
#Setting my working directory:
setwd("C:/Users/asque/Documents/ML/QuezadaMLbiol/UnitWorkflows/Code/")
#Setting my working directory:
setwd("C:/Users/asque/Documents/ML/QuezadaMLbiol/UnitWorkflows/Code/")
data <- read.csv("AirQualityUCI1.csv")
data <- read.csv("C:/Users/asque/Documents/ML/QuezadaMLbiol/UnitWorkflows/Data/AirQualityUCI1.csv")
#Data preparation
head(data)
dim(data)
data <- data[, 3:15]
is.na(data)
#To obtain the pollution column base on maximum level of concentration.
umbral_Nox.GT <- 53
umbral_C6H6 <- 5
umbral_CO <- 6
data$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
source(file = "colores.R")
palette <- colores("blind_fr")
par(mfrow = c(1, 3))
hist(data$CO.GT., col=palette)
hist(data$C6H6.GT., col=palette)
hist(data$NOx.GT., col=palette)
#To omit NAs
source(file = "na_delete.R")
#To omit NAs
source(file = "na_delete.R")
pre_clean <- na_delete(data$contaminacion)
pre_clean
dim(pre_clean)
data_clean <- na.omit(data)
data_clean
data_clean <- na_delete(data)
data_clean
dim(data_clean)
data_clean$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
data <- na_delete(data)
data$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
hist(data$CO.GT., col=palette, main ="Histogram of CO concetration")
hist(data$C6H6.GT., col=palette, main= "Histogram of Benzene concentration")
hist(data$NOx.GT., col=palette, main="Histogram of Nitrogen")
#my contamination column is numeric, I need to transform to factor
data$contaminacion <- factor(data$contaminacion,
levels = c(0, 1),
labels = c("L", "H"))
data1<-createDataPartition(data$contaminacion,
p=0.8,list=FALSE)
train <- data[data1,]
test <- data[-data1,]
x_train <- train[, -ncol(train)]
y_train <- train$contaminacion
#ML Method
#Quinlan's C5.0 algorithm
modelLookup("C5.0")
m_C5p0<-train(x=x_train,
y=y_train,
method="C5.0",
trControl=traincontrol,
tuneLength=3,
preProcess=c("center","scale"))
traincontrol<-trainControl(method="repeatedcv",number=10,repeats=3)
m_C5p0<-train(x=x_train,
y=y_train,
method="C5.0",
trControl=traincontrol,
tuneLength=3,
preProcess=c("center","scale"))
m_C5p0$results
max(m_C5p0$results$Accuracy) #-->0.9984999
#Setting my working directory:
setwd("C:/Users/asque/Documents/ML/QuezadaMLbiol/UnitWorkflows")
data <- read.csv("Data/AirQualityUCI1.csv")
png("Results/histograms.png", width = 1200, height = 400)
par(mfrow = c(1, 3))
hist(data$CO.GT., col=palette, main ="Histogram of CO concetration")
hist(data$C6H6.GT., col=palette, main= "Histogram of Benzene concentration")
hist(data$NOx.GT., col=palette, main="Histogram of Nitrogen")
dev.off()
#my contamination column is numeric, I need to transform to factor
data$contaminacion <- factor(data$contaminacion,
levels = c(0, 1),
labels = c("L", "H"))
data$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
#my contamination column is numeric, I need to transform to factor
data$contaminacion <- factor(data$contaminacion,
levels = c(0, 1),
labels = c("L", "H"))
#L --> Low
#H -> High
hist(data$contaminacion[labels])
#L --> Low
#H -> High
library(ggplot2)
# Create a bar plot for 'contaminacion' with custom labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar() +
scale_fill_manual(values = c("lightblue", "coral")) +  # Customize colors
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
#L --> Low
#H -> High
sum(is.na(data$contaminacion))
data <- na_delete(data)
sum(is.na(data))
data$contaminacion <- ifelse(data$CO.GT. > umbral_CO |
data$C6H6.GT. > umbral_C6H6 |
data$NOx.GT. > umbral_Nox.GT, 1, 0)
sum(is.na(data$contaminacion))
#my contamination column is numeric, I need to transform to factor
data$contaminacion <- factor(data$contaminacion,
levels = c(0, 1),
labels = c("L", "H"))
#L --> Low
#H -> High
sum(is.na(data$contaminacion))
library(ggplot2)
# Create a bar plot for 'contaminacion' with custom labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar() +
scale_fill_manual(values = c("lightblue", "coral")) +  # Customize colors
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
# Create a bar plot for 'contaminacion' with custom labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar() +
scale_fill_manual(values = palette) +  # Customize colors
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
# Create a bar plot with narrower bars and custom legend labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +  # Adjust bar width to make them narrower
scale_fill_manual(
values = palette,            # Use custom colors from palette
name = "Contamination Level", # Legend title
labels = c("Low", "High")     # Labels for L and H
) +
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
# Create a bar plot with narrower bars and custom legend labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.4) +  # Adjust bar width to make them narrower
scale_fill_manual(
values = palette,            # Use custom colors from palette
name = "Contamination Level", # Legend title
labels = c("Low", "High")     # Labels for L and H
) +
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
# Create a bar plot with narrower bars and custom legend labels
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.3) +  # Adjust bar width to make them narrower
scale_fill_manual(
values = palette,            # Use custom colors from palette
name = "Contamination Level", # Legend title
labels = c("Low", "High")     # Labels for L and H
) +
labs(title = "Contamination Levels", x = "Contamination", y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
save(m_C5p0<, file = "Results/model_results.RData")
save(m_C5p0, file = "Results/model_results.RData")
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 1200, height = 400)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.3) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
dev.off()
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 900, height = 400)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.3) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
dev.off()
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 300)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.3) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
dev.off()
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.3) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count") +
theme_minimal() +
theme(axis.text.x = element_text(size = 12), axis.title.x = element_text(size = 14))
dev.off()
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
dev.off()
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", face= "bold") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", face= "bold") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
dev.off()
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", )face= "bold" +
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
dev.off()
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = palette[1],
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
palette <- colores("blind_fr")
palette
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = "blind_fr",
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = "#35B779FF",
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = "#35B779FF", "#482878FF"  ,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = c("#35B779FF", "#482878FF" ) ,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = c("#35B779FF", "#482878FF" ) ,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
dev.off()
#ML Method
#Quinlan's C5.0 algorithm
modelLookup("C5.0")
traincontrol<-trainControl(method="repeatedcv",number=10,repeats=3)
m_C5p0<-train(x=x_train,
y=y_train,
method="C5.0",
trControl=traincontrol,
tuneLength=3,
preProcess=c("center","scale"))
m_C5p0$results
max(m_C5p0$results$Accuracy) #-->0.9984924
dir.create("Results")
save(m_C5p0, file = "Results/model_results.RData")
png("Results/histograms.png", width = 1200, height = 400)
par(mfrow = c(1, 3))
hist(data$CO.GT., col=palette, main ="Histogram of CO concetration")
hist(data$C6H6.GT., col=palette, main= "Histogram of Benzene concentration")
hist(data$NOx.GT., col=palette, main="Histogram of Nitrogen")
dev.off()
# Create a bar plot with narrower bars and custom legend labels
png("Results/high_low.png", width = 600, height = 600)
ggplot(data, aes(x = contaminacion, fill = contaminacion)) +
geom_bar(width = 0.5) +
scale_fill_manual(
values = c("#35B779FF", "#482878FF" ) ,
name = "Contamination Level",
labels = c("Low", "High")
) +
labs(title = "Contamination Levels", x = "Presence of contamination",
y = "Count", font=3) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size=14, face= "bold"),
axis.title.y = element_text(size=14, face = "bold")
)
dev.off()
print(m_C5p0$results)
table <- as.matrix(m_C5p0$results)
table
save(table, file = "Results/model_results.RData")
write.csv(m_C5p0$results, file = "Results/model_results.csv", row.names = FALSE)
ncol(data)
head(data)
